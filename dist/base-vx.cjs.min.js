"use strict";function _interopDefault(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(exports,"__esModule",{value:!0});var Vue=_interopDefault(require("vue"));const{$set:$set,$delete:$delete}=new Vue;let proxies={mutator:{copyWithin:"copyWithin",fill:"fill",unshift:"unshift",shift:"shift",push:"push",pop:"pop",reverse:"reverse",sort:"sort",splice:"splice"},accessor:{includes:"includes",concat:"concat",join:"join",slice:"slice",indexOf:"indexOf",lastIndexOf:"lastIndexOf",flat:"flat",toString:"toString",toLocaleString:"toLocaleString",forEach:"forEach",find:"find",findIndex:"findIndex",map:"map",filter:"filter",some:"some",every:"every",reduce:"reduce",reduceRight:"reduceRight",flatMap:"flatMap",keys:"keys",values:"values",entries:"entries",startsWith:"startsWith",endsWith:"endsWith",padEnd:"padEnd",padStart:"padStart",repeat:"repeat",normalize:"normalize",charAt:"charAt",charCodeAt:"charCodeAt",codePointAt:"codePointAt",localeCompare:"localeCompare",match:"match",replace:"replace",search:"search",split:"split",substr:"substr",substring:"substring",toLowerCase:"toLowerCase",toUpperCase:"toUpperCase",toLocaleLowerCase:"toLocaleLowerCase",toLocaleUpperCase:"toLocaleUpperCase",trim:"trim",trimLeft:"trimLeft",trimRight:"trimRight",toFixed:"toFixed",toPrecision:"toPrecision",toExponential:"toExponential"},custom:{set:set,del:del,increase:increase,decrease:decrease,toggle:toggle,each:each,q:q}};function set(t,e,...s){1===s.length?$set(t,e,s[0]):2===s.length&&$set(t[e],s[0],s[1])}function del(t,e,s){null==s?$delete(t,e):$delete(t[e],s)}function increase(t,e,s){t[e]=t[e]-(s&&"number"==typeof s?s:1)}function decrease(t,e,s){t[e]=t[e]+(s&&"number"==typeof s?s:1)}function toggle(t,e,...s){const i=t[e];Array.isArray(i)?s.forEach(t=>{const e=i.indexOf(t);~e?i.splice(e,1):i.push(t)}):"boolean"==typeof i&&(t[e]=!i)}function each(t,e,s,i){let o=t[e];isObj(o)?o=Object.entries(o):Array.isArray(o)&&(o=o.entries());for(let[r,n]of o)s.call(i,n,r,t[e])}function q(t,e,s){s(t[e],e,t)}function isObj(t){return t&&"[object Object]"===Object.prototype.toString.call(t)}function getTag(t){if("function"!=typeof t)for(let e in proxies){if(proxies[e][t])return e}else for(let e in proxies.custom){if(proxies.custom[e]===t)return"custom"}}function tailspin(t,e,s){let i=t,o=e.match(/[^\.\[\]]+/g);if(o){let t=(o=o.map(t=>Object.is(Number(t),NaN)?t:Number(t))).length;for(let[r,n]of o.entries()){if(null==i[n])throw new Error(`${e} -> path does not exist`);if(t<=r+1)return s(i,n);i=i[n]}}}let stores={};class BaseVX{constructor(...t){this._resetState(...t)._init()}static use(t){this._vuex=t}static add(t,e){return proxies.custom[t]=e,this}static only(t={},e){return"string"==typeof e&&(e=e.split(/ +/)),e.reduce((e,s)=>null==t[s]?e:(e[s]=t[s],e),{})}static singleton(...t){return this.instance&&this.instance._resetState(...t)||(this.instance=new BaseVX(...t))}static Store(t={}){return t.mutations&&(t.mutations={}),Object.assign(t.mutations,{[BaseVX.defaults.interiorKey]:mutation}),stores=new BaseVX._vuex.Store(t)}chain(t=!0){return this.options.chain=t,this}commit(){return stores.commit(BaseVX.defaults.interiorKey,[this.options._chainCallData,this.options]),this.options._chainCallData=[],this}_commit(t,e){return this.options._chainCallData.push({method:t,values:e}),this.options.chain||this.commit(),this}_resetState(...t){const[e,s={}]=t;return this.options={path:e,chain:s.chain||BaseVX.defaults.chain||!1,_chainCallData:[]},this}_init(){for(let t in proxies){const e=proxies[t];Object.keys(e).forEach(t=>BaseVX.prototype[t]=function(...s){return this._commit(e[t],s),this})}return this}}BaseVX.defaults={interiorKey:"__BaseVX__Mutation__",chain:!1};let vx=function(...t){return BaseVX.singleton(...t)};function mutation(t,e){const[s,i]=e,{path:o}=i;s.forEach(({method:e,values:s})=>{tailspin(t,o,function(t,i){if(["keys","values","entries"].includes(e))return void(isObj(t[i])&&(t[i]=Object[e](t[i])));switch(getTag(e)){case"mutator":t[i][e](...s);break;case"accessor":t[i]=t[i][e](...s);break;case"custom":e(t,i,...s)}})})}const version="0.0.1";exports.default=BaseVX,exports.vx=vx,exports.version="0.0.1";
